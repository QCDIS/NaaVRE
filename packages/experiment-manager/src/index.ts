import {
  JupyterFrontEnd,
  JupyterFrontEndPlugin
} from '@jupyterlab/application';
import { MainAreaWidget } from '@jupyterlab/apputils';
import { ILauncher } from '@jupyterlab/launcher';
import { ComposerWidget } from './Composer';
import { LabIcon } from '@jupyterlab/ui-components';



// const lfIcon = new LabIcon({
//     name: 'launcher:python-icon',
//     svgstr: '<?xml version="1.0" encoding="utf-8"?><svg id="b2b5d2a1-22b0-44f3-8aeb-4f68c7d734ad" data-name="Livello 1" width="700mm" height="413.56mm" viewBox="0 0 1984.25 1172.3" xmlns="http://www.w3.org/2000/svg">  <defs>    <style>      .e86b26fc-bd22-434c-9eea-4159b11fbd9e {        fill: #f3953f;      }      .ef438b8d-cacf-4575-b519-2195049476ab {        fill: #00853e;      }      .be59d4e2-9754-43cc-92f6-977be1dd81d3 {        fill: #00a3a6;      }      .ec8c43ac-3cdb-436e-ac10-890090120e6c {        fill: #e84e0f;      }      .f44e71a9-2d56-46b9-afb5-33cda3e3ed15 {        fill: #194383;      }      .f80c4e3b-8c0e-4cbe-a723-caa8e1a0958e {        fill: #224383;      }    </style>  </defs>  <g>    <path class="e86b26fc-bd22-434c-9eea-4159b11fbd9e" d="M723.81,695c.6,10-1.51,17.44-6.42,22.94-6.59,7.36-18.23,11.22-36.61,12.17-13.27.66-28.64-6.88-32.88-16.15-2.56-5.63-1-11.5,4.77-17.49,4.65-4.86,15.71-10.42,22.45-8,1.54.53,5.18,5.08,5,7.72,0,.29-.06.76-1.72,1a3.67,3.67,0,0,0,1.24,7.24c6.54-1.12,7.63-5.72,7.79-7.64.5-5.91-5.11-13.6-9.83-15.27-10.11-3.55-24,3.47-30.18,9.89-7.78,8.13-10,17.22-6.13,25.61,6.2,13.55,25.54,21.13,39.91,20.4a108.55,108.55,0,0,0,17.46-2.17c.45,1.79,9.19,36.35,10.52,41.6-30.53,12.07-62.92,5.6-88-1.54-17.77-5-30.7-30.8-32.07-40.2-3.19-22-.05-35.73,12.92-56.59,14.92-24,30.47-32.48,61.6-33.66C691.06,643.82,721.87,662.7,723.81,695Z"/>    <path class="ef438b8d-cacf-4575-b519-2195049476ab" d="M1315.37,239.89c30.9,1.5,49.28,34,49.75,61.53,14.54-10.14,17.55-28.36,34.32-37.44,17.26-9.34,40.53-13,59.51-18.32,14.83-4.15,30.33-5.77,45.42-8.76-24.77,38.76-52.28,107.16-103.41,117.32-12,2.39-23,1.84-31.08-6.68-3-3.12-3.93-6.42-7.75-8.8-22.44,16.08,8.42,61.59,21.74,74.81-6,7-15.6,4.5-13.06,6.92-1.53-13.89-10.35-26.05-18.38-37-3.9-5.34-6-10.72-8.26-16.68s2.21-18.58,1.73-24.6c-4.9,3-17.54,14.73-22,19.28-8.66,8.79-19.15,15.14-30.6,19.67-16.81,6.65-51.09,17.06-68.4,9.62,2.66-18.63,11.66-35.45,18.6-52.7,4.11-10.21,7.26-22.13,17.84-27.06,20.85-9.72,52,2.12,71,8.35-1.91-14.23-18.89-24-24.23-36.94-2.52-6.09-5.81-14.19-4.66-21,1.44-8.45,8.86-12.36,11.37-19.47Z"/>    <path class="ef438b8d-cacf-4575-b519-2195049476ab" d="M846.22,214.17c-13.61-8.28-45.7-11.28-62.76-13.35-26.53-3.22-46.81-2.83-73.13,3-24,5.31-37.76,22.56-52.26,41.64-11.48-13.82-19-21.62-23.44-40.48-3.86-16.57-4.11-17.49-22.09-21.9a187.82,187.82,0,0,0-33.31-4.79c2.9,20.88,16.41,34.61,25.93,39.62,17.7,9.32,20.66,16.85,30.8,32.44-31.15-1.13-56.48-16.19-87.24-18.42-51.84-3.76-126.18,9.4-167.26,41.85,13.4,16.56,51.12,23.73,70.8,27.68,15.8,3.17,31,7.31,47.14,9.06,26.61,2.91,53.79,7,79.74,3.54,18.13-2.42,30.79-2,45.6-11.61,15.34-9.92,16.91-5.33,36.18-1.95-5.26,10.26,6.1,20.7,5.31,32.64-1,15.8-3.31,31.16-.13,46.7,21.12,5.17,51-13.46,71-20,13.66-4.47,28.78-9.13,42.88-9.33-2.17-14.53-28.49-37.93-42.24-42.73-12.1-4.23-27.45-2.33-37.43-10.79,35.16-5.22,85.8-7.66,112.58-33,15.39-14.57,26.79-32.95,37.21-50.63"/>    <path class="be59d4e2-9754-43cc-92f6-977be1dd81d3" d="M1343,741c-9.21,8.88-71.81,28-88.18,31.27-49.12,9.75-103.56,7.44-151-17.12-30-15.5-59-47.17-90.27-55.17-36.35-9.32-73,49.35-109.8,43.94,3.49-21,29.26-62.07,30.39-75,.91-10.72,2-23.3,1.85-34.08-.14-13.55-4-25.69-2.36-39.58,34.68,45.29,45.31,66.5,91.27,78.5,31.56,8.26,58.64,2.06,91.06-7.23,25.75-7.38,50-19.32,75.71-17.48,13.28.94,47.41,12.17,75.16,25.27,10.57,5,21.07,13.28,31.24,23.22C1314.55,713.7,1343,741,1343,741Z"/>    <path class="ec8c43ac-3cdb-436e-ac10-890090120e6c" d="M1069,307.77c30.2-21.12,64-70.55,53.1-108.79-14.09-49.64-53.53-62.13-98.94-59.63-37.27,2.05-75,8.11-100.59,38.09-28.29,33.09-8.57,86,14.68,118.11,21.36,29.49,45,26.27,75.58,20.49,15.89-3,41.64,2.45,52.14-7.68"/>    <path class="f44e71a9-2d56-46b9-afb5-33cda3e3ed15" d="M819.68,614.3c-30.79,21.44-31.23,83.05-20.1,115.36,10,29,55.16,136.61,70.45,69.59,7.49-32.79-7.66-90.53-18.09-121.53-7.79-23.16-30.35-43.62-35.4-69.71"/>    <g>      <path class="f44e71a9-2d56-46b9-afb5-33cda3e3ed15" d="M358.46,564.83l-6,84.09H131.78V634.66q4.71-.39,13.66-1.4t12.5-2.59a17.06,17.06,0,0,0,8.55-7.58q2.65-5,2.66-12.76V407.68a29.68,29.68,0,0,0-2.27-12q-2.26-5.19-8.94-8.38a67.49,67.49,0,0,0-12.7-4.68,72.1,72.1,0,0,0-13.46-2.7V365.69H251.26V380a94.75,94.75,0,0,0-14.55,2,109.54,109.54,0,0,0-12.94,3.19q-6.83,2.39-9.34,8.17a30.79,30.79,0,0,0-2.5,12.36v190a124,124,0,0,0,1.29,20.43q1.29,7.29,6.07,11.27,4.56,3.58,13.62,4.69a224.62,224.62,0,0,0,25.36,1.09q7.35,0,15.31-.39a130.27,130.27,0,0,0,15.12-1.6,77,77,0,0,0,12.83-3.27q5.87-2.08,8.65-5.27,8.16-9.14,19-27.71t15-30.11Z"/>      <path class="ec8c43ac-3cdb-436e-ac10-890090120e6c" d="M467.43,648.92H372V635.64c3.07-.26,6.23-.53,9.51-.79a36.13,36.13,0,0,0,8.5-1.6,14.35,14.35,0,0,0,8.3-6.27q2.7-4.47,2.7-11.64V494.14a23.91,23.91,0,0,0-2.88-11.64,25.63,25.63,0,0,0-8-8.86,36.61,36.61,0,0,0-10.91-4.07,79.66,79.66,0,0,0-13.09-2.09V454.2l69.49-4.43,2.79,2.79V612.91a22.6,22.6,0,0,0,2.68,11.56,15.91,15.91,0,0,0,8.45,6.78,67.28,67.28,0,0,0,8.54,2.9,52.48,52.48,0,0,0,9.34,1.49ZM442.36,372.15a29.24,29.24,0,0,1-7.49,19.94,23.66,23.66,0,0,1-18.48,8.51q-10.18,0-17.68-8.11A26.58,26.58,0,0,1,391.22,374a27.64,27.64,0,0,1,7.49-19.23q7.49-8.21,17.68-8.22,11.39,0,18.68,7.72A25.35,25.35,0,0,1,442.36,372.15Z"/>      <path class="f44e71a9-2d56-46b9-afb5-33cda3e3ed15" d="M633.76,363.55a23.94,23.94,0,0,1-4.8,15.14q-4.8,6.18-14.58,6.18a22.16,22.16,0,0,1-10.9-2.59,33.59,33.59,0,0,1-8.69-7,62.94,62.94,0,0,1-7.4-10q-3.4-5.58-5.8-9Q568.21,357,560.9,375t-7.29,57.56v20.15h50.65V471.9H553.61V613.28q0,7,2.71,11.38a16.27,16.27,0,0,0,8.51,6.59,61.19,61.19,0,0,0,12.82,2.89q8,1.11,13.82,1.5v13.28H487.23V635.64l9.5-.8a36.12,36.12,0,0,0,8.51-1.6,14.32,14.32,0,0,0,8.3-6.28q2.7-4.5,2.7-11.69V471.9H477.4V452.72h38.84V440.15q0-44.86,23.32-72.69t58.37-27.83q17.82,0,26.82,7T633.76,363.55Z"/>      <path class="ef438b8d-cacf-4575-b519-2195049476ab" d="M782.27,602.9A100.75,100.75,0,0,1,749,640.37q-20.84,13.95-47.89,14-23.85,0-41.78-8.4a81.92,81.92,0,0,1-29.56-22.8,97,97,0,0,1-17.33-33.6,141.58,141.58,0,0,1-5.71-40.6,119.32,119.32,0,0,1,6.11-37.7,106.28,106.28,0,0,1,17.92-33.3A86.8,86.8,0,0,1,659.1,455q16.9-8.7,37.95-8.71,21.62,0,37.05,6.79a66,66,0,0,1,25,18.57,74.13,74.13,0,0,1,13.71,26.36,115.19,115.19,0,0,1,4.51,33v13.17H646.56a155.55,155.55,0,0,0,3.71,35.41A84.5,84.5,0,0,0,662,607.54,55.83,55.83,0,0,0,682.51,626q12.66,6.75,30.14,6.74,17.88,0,30.84-8.33t25-30Zm-44.75-75.44a163.36,163.36,0,0,0-1.89-23.88q-1.89-12.74-6.09-21.3A40.54,40.54,0,0,0,717,467.35q-8-5.78-20.54-5.77-21,0-34.81,17.41t-15.06,48.47Z"/>      <path class="f44e71a9-2d56-46b9-afb5-33cda3e3ed15" d="M1164.68,380a45.16,45.16,0,0,0-11.6,2.3,56.85,56.85,0,0,0-12.19,5.48,41.58,41.58,0,0,0-11.29,10.07q-4.3,5.68-7.49,15.86-14.2,46.07-33,107.58t-40.57,131.12h-18.47L958.45,434.14,884.12,652.36H866.46q-19.8-69.79-41-144.88T797.1,406.87a35.35,35.35,0,0,0-5.29-11,38.44,38.44,0,0,0-21.19-13.85,71.83,71.83,0,0,0-12.1-2.1V365.69H874.15V380a178.69,178.69,0,0,0-25.87,3q-10.69,2.19-10.68,7.37a31.1,31.1,0,0,0,.6,5.29q.6,3.3,1,5.28,4.57,17.57,16.28,58.07t34.69,121.36l70.72-210.7h19.55l71.38,214.94Q1066.24,535,1076.68,498t17.24-63.39q4.8-18.57,6-25.45a69.65,69.65,0,0,0,1.19-11.67q0-6.78-9.28-11.36T1061.77,380V365.69h102.91Z"/>      <path class="ec8c43ac-3cdb-436e-ac10-890090120e6c" d="M1323.32,645.34q-9.37,3.36-16.45,5.44a57.26,57.26,0,0,1-16,2.07q-15.57,0-24.84-7.29t-11.86-21.27h-1.19q-12.89,14.37-27.63,22t-35.56,7.58q-22,0-36.16-13.57t-14.16-35.55a60.81,60.81,0,0,1,3.18-20.36,48.52,48.52,0,0,1,9.52-16.18,47.65,47.65,0,0,1,13.09-10.68,115.25,115.25,0,0,1,15.28-7.49q8.91-3.39,36.21-12.58T1253.5,523V503.47a84.25,84.25,0,0,0-1.09-9.88,41.35,41.35,0,0,0-4.65-13.83A39.43,39.43,0,0,0,1236.59,467q-7.23-5.43-20.47-5.43a46.15,46.15,0,0,0-16.91,3.05q-7.82,3.06-11,6.4a52.94,52.94,0,0,0,1.9,11.63,59.26,59.26,0,0,1,1.91,14.19q0,6.88-6.32,12.61t-17.52,5.71q-10,0-14.73-7.08a28,28,0,0,1-4.7-15.87q0-9.17,6.45-17.55a64.86,64.86,0,0,1,16.8-15,91.17,91.17,0,0,1,21.66-9.47,84.52,84.52,0,0,1,24.85-3.9,161.07,161.07,0,0,1,29.11,2.31,53.35,53.35,0,0,1,22.56,9.89,46,46,0,0,1,15.4,20.1q5.26,12.71,5.27,32.68,0,28.6-.49,50.7t-.49,48.28q0,7.82,2.66,12.41a21.82,21.82,0,0,0,8.22,7.79c2,1.2,5.1,1.87,9.39,2s8.68.2,13.16.2ZM1253.9,539.76q-16.87,5-29.58,9.82a120.16,120.16,0,0,0-23.63,12A53.9,53.9,0,0,0,1185,577.76q-5.77,9.33-5.76,22.16,0,16.64,8.61,24.46t21.89,7.82a44.54,44.54,0,0,0,24.74-6.92,72.48,72.48,0,0,0,18-16.34Z"/>      <path class="ef438b8d-cacf-4575-b519-2195049476ab" d="M1448.69,640.71q-12.92,5.32-24.43,9T1396,653.34q-24.63,0-34.67-12.5t-10-35.31V471.9h-35.41V452.72h36.2V391.26h36.18v61.46h56V471.9h-55.56V582.55a199.28,199.28,0,0,0,.89,20.78,39,39,0,0,0,4.27,14.56,20.5,20.5,0,0,0,9.53,8.84q6.36,3,17.09,3c3.3,0,8.18-.32,14.6-1s11-1.46,13.6-2.47Z"/>      <path class="ec8c43ac-3cdb-436e-ac10-890090120e6c" d="M1547.06,654.33q-42.93,0-67.21-28.4t-24.27-76.2a113.9,113.9,0,0,1,6.53-38.9,107.1,107.1,0,0,1,19-32.9,89.4,89.4,0,0,1,68.66-31.6q29.12,0,47.38,13.9t18.27,37.9a32.82,32.82,0,0,1-4.79,17.7q-4.78,7.7-15.74,7.7-11.76,0-18.23-6t-6.48-13.34a74.81,74.81,0,0,1,2.39-18.43,101,101,0,0,0,2.8-13.85,17.86,17.86,0,0,0-10.79-8.26,54.65,54.65,0,0,0-15.43-2.09,43,43,0,0,0-18.45,4.1q-8.79,4.1-17,15.11-7.47,10-12.1,27t-4.64,40.62q0,37.23,16.55,60.74t43.44,23.52q19.44,0,32.59-9.46t24.39-28.4l12.84,8.38a103.28,103.28,0,0,1-34.91,37.34Q1570.13,654.32,1547.06,654.33Z"/>      <path class="f44e71a9-2d56-46b9-afb5-33cda3e3ed15" d="M1848.38,648.92h-96.87V635.64c3.08-.26,6.48-.53,10.23-.8a38.4,38.4,0,0,0,9.23-1.6,14.44,14.44,0,0,0,8.32-6.3q2.7-4.5,2.71-11.71V513.77q0-21-9.89-32.43t-24-11.41a54.94,54.94,0,0,0-19.28,3.31,72.74,72.74,0,0,0-15.87,8.1,46.64,46.64,0,0,0-10.38,10c-2.4,3.33-4.27,6.14-5.6,8.4V613.23a21,21,0,0,0,2.71,11.2,17.38,17.38,0,0,0,8.33,6.81,43.7,43.7,0,0,0,9.12,3,74.17,74.17,0,0,0,10.33,1.4v13.28h-96.87V635.64q4.56-.39,9.54-.9a45.87,45.87,0,0,0,8.35-1.5,14.73,14.73,0,0,0,8.34-6.27q2.78-4.5,2.78-11.68v-229a32.6,32.6,0,0,0-3.08-13.56,24,24,0,0,0-8-10.18q-3.59-2.58-12.63-3.69t-14.6-1.5V344.06l72.93-4.43,2.79,3v137.3h.8q6.57-6.58,12-11.7a95.73,95.73,0,0,1,14.16-10.7,75.12,75.12,0,0,1,17.84-8,77.05,77.05,0,0,1,23-3.21q26.32,0,40.48,16.7t14.16,48.07V613.65q0,7,2.52,11.3t8.36,6.7a67.83,67.83,0,0,0,8.36,2.69,59.14,59.14,0,0,0,9.77,1.3Z"/>    </g>    <g/>  </g></svg>',
//   });

const wfIcon = new LabIcon({
  name: 'launcher:python-icon',
  svgstr: '<svg xmlns="http://www.w3.org/2000/svg" width="66.69" height="66.69" viewBox="0 0 66.69 66.69"><defs><style>      .a92fba6e-7ebd-4c32-8963-8296e20ef654 {        fill: #0f4e8b;      }    </style></defs><g id="a472ef7c-dd17-4d49-9df0-027f7f177a8f" data-name="Livello 2"><g id="b55479a9-ce75-42ce-9f6a-fdbd00d931c6" data-name="Livello 1"><g><path class="a92fba6e-7ebd-4c32-8963-8296e20ef654" d="M33.34,40.87a5.38,5.38,0,1,0,5.38,5.38,5.39,5.39,0,0,0-5.38-5.38Zm0,8.61a3.23,3.23,0,1,1,3.23-3.23,3.23,3.23,0,0,1-3.23,3.23Z"></path><rect class="a92fba6e-7ebd-4c32-8963-8296e20ef654" x="32.27" y="4.3" width="8.6" height="2.15"></rect><rect class="a92fba6e-7ebd-4c32-8963-8296e20ef654" x="32.27" y="8.6" width="8.6" height="2.15"></rect><rect class="a92fba6e-7ebd-4c32-8963-8296e20ef654" x="25.81" y="12.91" width="15.06" height="2.15"></rect><rect class="a92fba6e-7ebd-4c32-8963-8296e20ef654" x="25.81" y="17.21" width="15.06" height="2.15"></rect><rect class="a92fba6e-7ebd-4c32-8963-8296e20ef654" x="25.81" y="21.51" width="15.06" height="2.15"></rect><path class="a92fba6e-7ebd-4c32-8963-8296e20ef654" d="M66.69,34.42V25.81H51.63v8.61h6.45V45.17H45.17V43.32l-2.64-.88L43.78,40l-4.14-4.14-2.49,1.25-.88-2.64H34.42V28H45.17V15.06H58.08v6L55.62,18.6l-1.53,1.52,5.07,5.06,5.06-5.06L62.7,18.6l-2.47,2.47V12.91H45.17V0H28.6L21.51,7.08v5.83H6.45v8.16L4,18.6,2.47,20.12l5.06,5.06,5.06-5.06L11.07,18.6,8.6,21.07v-6H21.51V28H32.27v6.45H30.42l-.88,2.64-2.49-1.25L22.91,40l1.24,2.49-2.64.88v1.85H8.6V34.42h6.46V25.81H0v8.61H6.45V51.78a4.31,4.31,0,1,0,2.15,0V47.33h6.46v13.1a3.23,3.23,0,1,0,2.15,0V47.33h4.3v1.85l2.64.88-1.24,2.49,4.14,4.14,2.49-1.25.88,2.64h5.85l.88-2.64,2.49,1.25,4.14-4.14-1.25-2.49,2.64-.88V47.33h4.31v13.1a3.23,3.23,0,1,0,2.15,0V47.33h6.45v4.45a4.31,4.31,0,1,0,2.15,0V34.42ZM28,3.67V6.45H25.18ZM23.66,8.6h6.46V2.15H43V25.81H23.66ZM2.15,28H12.91v4.3H2.15Zm7.53,28a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15Zm6.45,8.61a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08ZM43,47.63l-2.46.82-.19.47c0,.14-.1.28-.16.41L40,49.8l1.16,2.32-1.94,2-2.33-1.16-.46.2-.41.17-.48.18-.82,2.47H32l-.83-2.47-.48-.18-.4-.17-.46-.2-2.33,1.16-1.95-2,1.17-2.32-.21-.47c-.06-.13-.11-.27-.17-.41l-.18-.47-2.47-.82V44.87l2.47-.82.18-.47c.06-.14.11-.28.17-.41l.21-.47-1.17-2.32,1.95-2,2.33,1.16.46-.2.4-.17.48-.18L32,36.57h2.75L35.54,39l.48.18.41.17.46.21,2.33-1.17,1.94,2L40,42.7l.21.47c.06.13.11.27.17.41l.18.47,2.46.83Zm7.53,16.91a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08Zm10.76-8.61a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15ZM53.78,28H64.54v4.3H53.78Z"></path></g></g></g></svg>',
});


namespace CommandIDs {
  export const create = 'create-vre-composer';
}

const extension: JupyterFrontEndPlugin<void> = {
  id: 'vre-composer',
  autoStart: true,
  optional: [ILauncher],
  activate: (app: JupyterFrontEnd, launcher: ILauncher) => {
      const { commands } = app;
      const command = CommandIDs.create;
      commands.addCommand(command, {
          caption: 'Launch Workflow Composition',
          label: 'Experiment Manager',
          icon: args => (args['isPalette'] ? null : wfIcon),
          execute: () => {
            const content = new ComposerWidget();
            const widget = new MainAreaWidget<ComposerWidget>({ content });
            widget.title.label = 'Experiment Manager';
            content.populateToolbar(widget.toolbar)
            app.shell.add(widget, 'main');
          }
      });
    
      if (launcher) {
          launcher.add({
              command,
              category: 'VRE Components',
              rank: 0
          }); 
      }
  }
};

export default extension;